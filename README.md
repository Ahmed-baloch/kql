# <p align="center">Sentinel KQL</p>
In this repository you may find KQL (Kusto Query Language) queries and Watchlist schemes for data sources related to Microsoft Sentinel (a SIEM tool).

I will be commenting the queries in [this Twitter thread](https://twitter.com/ep3p/status/1556248792269066241).

In the folder *Azure-Sentinel* you may find ***upgraded*** [Microsoft content from their repository](https://github.com/Azure/Azure-Sentinel), that might not be worth to commit in that repository, where I have contributed [several pull requests](https://github.com/Azure/Azure-Sentinel/pulls?q=is%3Apr+author%3Aep3p) and I have appeared in their [Threat Hunters leaderboard](https://github.com/Azure/Azure-Sentinel/blob/master/Tools/stats/stats.md) (the scores might not be updated for several months).

You could check other resources like:
- https://github.com/reprise99/awesome-kql-sentinel (start here)
- https://github.com/reprise99/Sentinel-Queries
- https://github.com/rod-trent/SentinelKQL
- https://github.com/FalconForceTeam/FalconFriday
- https://github.com/Cyb3r-Monk/Threat-Hunting-and-Detection
- https://github.com/Bert-JanP/Hunting-Queries-Detection-Rules
- https://github.com/alexverboon/Azure-Threat-Research-Matrix-KQL
- https://github.com/OTRF/Microsoft-Sentinel2Go
- https://github.com/eshlomo1/Microsoft-Sentinel-4-SecOps
- https://github.com/Kaidja/Azure-Sentinel
- ...

Other links:
- [docs.microsoft.com Kusto Query Language (KQL) Shortcuts](https://docs.microsoft.com/en-us/azure/data-explorer/kusto/tools/kusto-explorer-shortcuts)
- [docs.microsoft.com Azure AD audit activity reference](https://docs.microsoft.com/en-us/azure/active-directory/reports-monitoring/reference-audit-activities)
- [docs.microsoft.com Azure AD security operations guide](https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/security-operations-introduction)
- [LookUp Microsoft SignInLogs Error Codes (ResultType)](https://login.microsoftonline.com/error)
  - [acalarch/azure-signinlog-results](https://github.com/acalarch/azure-signinlog-results/blob/main/signinlog-results.txt)
- [graphpermissions.merill.net Microsoft Graph Permission Explorer](https://graphpermissions.merill.net/index.html) (Old permissions may appear if you write them in the URI path)
- [microsoft/msticpy](https://github.com/microsoft/msticpy)
- [techcommunity.microsoft.com Microsoft Sentinel Ninja Training](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/become-a-microsoft-sentinel-ninja-the-complete-level-400/ba-p/1246310)
- [techcommunity.microsoft.com Data ingestion with Azure Storage and KQL](https://techcommunity.microsoft.com/t5/microsoft-sentinel-blog/using-external-data-sources-to-enrich-network-logs-using-azure/ba-p/1450345)
- [OTRF/Microsoft-Sentinel2Go](https://github.com/OTRF/Microsoft-Sentinel2Go)
- [garybushey.com Blog Gary Bushey](https://garybushey.com/)
  - [Markdown in Analytics Rules description](https://garybushey.com/2022/08/07/use-an-analytic-rules-description-for-remediation-steps/)
- [adr.iaan.be Query LogAnalytics from LogicApp](https://adr.iaan.be/blog/querying-log-analytics-from-logic-apps/)
- [Accelerynt-Security/AS-IP-Blocklist LogicApp IP Address Alert to Conditional Access](https://github.com/Accelerynt-Security/AS-IP-Blocklist)
- [Accelerynt-Security/AS-Teams-Integration LogicApp to Teams channel](https://github.com/Accelerynt-Security/AS-Teams-Integration)
- [Accelerynt-Security/AS-Domain-Watchlist LogicApp Alert Entity to Watchlist](https://github.com/Accelerynt-Security/AS-Domain-Watchlist)
